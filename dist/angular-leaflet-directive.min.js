/**!
 * The MIT License
 *
 * Copyright (c) 2013 the angular-leaflet-directive team, http://tombatossals.github.io/angular-leaflet-directive
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 * angular-google-maps
 * https://github.com/tombatossals/angular-leaflet-directive
 *
 * @authors https://github.com/tombatossals/angular-leaflet-directive/graphs/contributors
 */

/*! angular-leaflet-directive 22-10-2013 */
!function(){"use strict";function a(a){return angular.isDefined(a)}function b(a){return angular.isNumber(a)}function c(a){return angular.isString(a)}function d(a){return angular.isArray(a)}function e(a){var b=a.$root.$$phase;return!("$apply"===b||"$digest"===b)}function f(a,b){e(a)?a.$apply(b):a.$eval(b)}function g(b){var c=h();return a(b)&&(c.maxZoom=a(b.maxZoom)?parseInt(b.maxZoom,10):c.maxZoom,c.minZoom=a(b.minZoom)?parseInt(b.minZoom,10):c.minZoom,c.doubleClickZoom=a(b.doubleClickZoom)&&b.doubleClickZoom?!0:!1,c.scrollWheelZoom=a(b.scrollWheelZoom)&&b.scrollWheelZoom?!0:!1,c.attributionControl=a(b.attributionControl)&&b.attributionControl?!0:!1,c.tileLayer=a(b.tileLayer)?b.tileLayer:c.tileLayer,a(b.tileLayerOptions)&&angular.copy(b.tileLayerOptions,c.tileLayerOptions)),c}function h(){return{maxZoom:14,minZoom:1,doubleClickZoom:!0,scrollWheelZoom:!0,zoomControl:!0,attributionControl:!0,zoomsliderControl:!1,controlLayersPosition:"topright",tileLayer:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",tileLayerOptions:{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},icon:{url:"http://cdn.leafletjs.com/leaflet-0.6.4/images/marker-icon.png",retinaUrl:"http://cdn.leafletjs.com/leaflet-0.6.4/images/marker-icon-2x.png",size:[25,41],anchor:[12,40],popup:[0,-40],shadow:{url:"http://cdn.leafletjs.com/leaflet-0.6.4/images/marker-shadow.png",retinaUrl:"http://cdn.leafletjs.com/leaflet-0.6.4/images/marker-shadow.png",size:[41,41],anchor:[12,40]}},path:{weight:10,opacity:1,color:"#0000ff"},center:{lat:0,lng:0,zoom:1}}}var i={AwesomeMarkersPlugin:{isLoaded:function(){return void 0!==L.AwesomeMarkers?void 0!==L.AwesomeMarkers.Icon:!1},is:function(a){return this.isLoaded()?a instanceof L.AwesomeMarkers.Icon:!1},equal:function(a,b){return this.isLoaded?this.is(a)&&this.is(b)?a.options.icon===b.options.icon&&a.options.iconColor===b.options.iconColor&&a.options.color===b.options.color&&a.options.iconSize[0]===b.options.iconSize[0]&&a.options.iconSize[1]===b.options.iconSize[1]&&a.options.iconAnchor[0]===b.options.iconAnchor[0]&&a.options.iconAnchor[1]===b.options.iconAnchor[1]&&a.options.popupAnchor[0]===b.options.popupAnchor[0]&&a.options.popupAnchor[1]===b.options.popupAnchor[1]&&a.options.shadowAnchor[0]===b.options.shadowAnchor[0]&&a.options.shadowAnchor[1]===b.options.shadowAnchor[1]&&a.options.shadowSize[0]===b.options.shadowSize[0]&&a.options.shadowSize[1]===b.options.shadowSize[1]:!1:!1}},MarkerClusterPlugin:{isLoaded:function(){return void 0!==L.MarkerClusterGroup},is:function(a){return this.isLoaded()?a instanceof L.MarkerClusterGroup:!1}},GoogleLayerPlugin:{isLoaded:function(){return void 0!==L.Google},is:function(a){return this.isLoaded()?a instanceof L.Google:!1}},BingLayerPlugin:{isLoaded:function(){return void 0!==L.BingLayer},is:function(a){return this.isLoaded()?a instanceof L.BingLayer:!1}},Leaflet:{DivIcon:{is:function(a){return a instanceof L.DivIcon},equal:function(a,b){return this.is(a)&&this.is(b)?a.options.html===b.options.html&&a.options.iconSize[0]===b.options.iconSize[0]&&a.options.iconSize[1]===b.options.iconSize[1]&&a.options.iconAnchor[0]===b.options.iconAnchor[0]&&a.options.iconAnchor[1]===b.options.iconAnchor[1]:!1}},Icon:{is:function(a){return a instanceof L.Icon},equal:function(a,b){return this.is(a)&&this.is(b)?a.options.iconUrl===b.options.iconUrl&&a.options.iconRetinaUrl===b.options.iconRetinaUrl&&a.options.iconSize[0]===b.options.iconSize[0]&&a.options.iconSize[1]===b.options.iconSize[1]&&a.options.iconAnchor[0]===b.options.iconAnchor[0]&&a.options.iconAnchor[1]===b.options.iconAnchor[1]&&a.options.shadowUrl===b.options.shadowUrl&&a.options.shadowRetinaUrl===b.options.shadowRetinaUrl&&a.options.shadowSize[0]===b.options.shadowSize[0]&&a.options.shadowSize[1]===b.options.shadowSize[1]&&a.options.shadowAnchor[0]===b.options.shadowAnchor[0]&&a.options.shadowAnchor[1]===b.options.shadowAnchor[1]&&a.options.popupAnchor[0]===b.options.popupAnchor[0]&&a.options.popupAnchor[1]===b.options.popupAnchor[1]:!1}}}};angular.module("leaflet-directive",[]).directive("leaflet",["$log","leafletData",function(b,c){return{restrict:"E",replace:!0,transclude:!0,scope:{center:"=center",defaults:"=defaults",maxBounds:"=maxbounds",bounds:"=bounds",marker:"=marker",markers:"=markers",legend:"=legend",geojson:"=geojson",paths:"=paths",tiles:"=tiles",layers:"=layers",customControls:"=customControls",eventBroadcast:"=eventBroadcast"},template:'<div class="angular-leaflet-map" ng-transclude></div>',controller:["$scope",function(a){this.getMap=function(){return a.map}}],link:function(d,e,f){function h(b,c){b.zoomControl&&a(c.zoomControlPosition)&&b.zoomControl.setPosition(c.zoomControlPosition),b.zoomControl&&a(c.zoomControl)&&c.zoomControl===!1&&b.zoomControl.removeFrom(b),b.zoomsliderControl&&a(c.zoomsliderControl)&&c.zoomsliderControl===!1&&b.zoomsliderControl.removeFrom(b)}var i=g(d.defaults);d.maxBounds&&(i.minZoom=void 0),f.width&&(isNaN(f.width)?e.css("width",f.width):e.css("width",f.width+"px")),f.height&&(isNaN(f.height)?e.css("height",f.height):e.css("height",f.height+"px")),d.$on("leafletDirectiveSetMap",function(a,b){var c=b.shift();j[c].apply(j,b)});var j=new L.Map(e[0],{maxZoom:i.maxZoom,minZoom:i.minZoom,doubleClickZoom:i.doubleClickZoom,scrollWheelZoom:i.scrollWheelZoom,attributionControl:i.attributionControl});if(d.map=j,c.setMap(j),a(f.center)||(b.warn("[AngularJS - Leaflet] 'center' is undefined in the current scope, did you forget to initialize it?"),j.setView([i.center.lat,i.center.lng],i.center.zoom)),!a(f.tiles)&&!a(f.layers)){var k=i.tileLayer,l=i.tileLayerOptions,m=L.tileLayer(k,l);m.addTo(j)}h(j,i)}}}]),angular.module("leaflet-directive").directive("center",["$log","$parse",function(c,d){return{restrict:"A",scope:!1,replace:!1,transclude:!1,require:"leaflet",link:function(e,h,i,j){function k(a){if(e.bounds){var b=a.getBounds(),c=b.getSouthWest(),d=b.getNorthEast();e.bounds={southWest:{lat:c.lat,lng:c.lng},northEast:{lat:d.lat,lng:d.lng}}}}function l(a,b){a.setView([b.lat,b.lng],b.zoom),k(a)}function m(c){return a(c)&&b(c.lat)&&b(c.lng)&&b(c.zoom)}function n(b,g,h){if(a(g)){g.autoDiscover===!0&&b.locate({setView:!0,maxZoom:h.maxZoom});var i={lat:d("center.lat"),lng:d("center.lng"),zoom:d("center.zoom")}}var j=!1;e.$watch("center",function(a){return m(a)?(j||l(b,a),void 0):(c.warn("[AngularJS - Leaflet] invalid 'center'"),l(b,h.center),void 0)},!0),b.on("movestart",function(){j=!0}),b.on("moveend",function(){j=!1,f(e,function(a){i&&(i.lat.assign(a,b.getCenter().lat),i.lng.assign(a,b.getCenter().lng),i.zoom.assign(a,b.getZoom())),a.$emit("centerUpdated")})})}var o=g(e.defaults),p=j.getMap(),q=e.center;n(p,q,o)}}}]),angular.module("leaflet-directive").directive("tiles",["$log","leafletData",function(a,b){return{restrict:"A",scope:!1,replace:!1,transclude:!1,require:"leaflet",link:function(a,c,d,e){function f(c,d,e){var f,g=e.tileLayer,h=e.tileLayerOptions;angular.isDefined(d.url)&&(g=d.url),angular.isDefined(d.options)&&angular.copy(d.options,h),a.$watch("tiles.url",function(a){angular.isDefined(a)&&f.setUrl(a)}),f=L.tileLayer(g,h),b.setTile(f),f.addTo(c)}var h=g(a.defaults),i=e.getMap(),j=a.tiles;f(i,j,h)}}}]),angular.module("leaflet-directive").directive("legend",["$log",function(a){return{restrict:"A",scope:!1,replace:!1,transclude:!1,require:"leaflet",link:function(b,c,e,f){function g(b,c){if(d(c.colors)&&d(c.labels)&&c.colors.length===c.labels.length){var e=c.legendClass?c.legendClass:"legend",f=c.position||"bottomright",g=L.control({position:f});g.onAdd=function(){for(var a=L.DomUtil.create("div",e),b=0;b<c.colors.length;b++)a.innerHTML+='<div><i style="background:'+c.colors[b]+'"></i>'+c.labels[b]+"</div>";return a},g.addTo(b)}else a.warn("[AngularJS - Leaflet] legend.colors and legend.labels must be set.")}var h=f.getMap(),i=b.legend;g(h,i)}}}]),angular.module("leaflet-directive").directive("geojson",["$log","$rootScope",function(b,c){return{restrict:"A",scope:!1,replace:!1,transclude:!1,require:"leaflet",link:function(b,d,e,g){function h(d){b.$watch("geojson",function(e){if(a(e)&&(a(i)&&d.removeLayer(b.leaflet.geojson),a(e.data))){var g=e.resetStyleOnMouseout;i=L.geoJson(e.data,{style:e.style,onEachFeature:function(a,d){d.on({mouseover:function(d){f(b,function(){e.selected=a,c.$broadcast("leafletDirectiveMap.geojsonMouseover",d)})},mouseout:function(a){g&&i.resetStyle(a.target),f(b,function(){e.selected=void 0,c.$broadcast("leafletDirectiveMap.geojsonMouseout",a)})},click:function(a){f(b,function(){c.$broadcast("leafletDirectiveMap.geojsonClick",e.selected,a)})}})}}).addTo(d)}})}var i,j=g.getMap();h(j)}}}]),angular.module("leaflet-directive").directive("layers",["$log","leafletData",function(b){return{restrict:"A",scope:!1,replace:!1,transclude:!1,require:"leaflet",link:function(d,e,f,h){function j(c,e,f){if(a(e)){if(!a(e.baselayers)||Object.keys(d.layers.baselayers).length<=0)return b.error("[AngularJS - Leaflet] At least one baselayer has to be defined"),void 0;var g={};g.baselayers={},g.controls={},g.controls.layers=new L.control.layers,g.controls.layers.setPosition(f.controlLayersPosition),g.controls.layers.addTo(c);var h=!1;for(var i in e.baselayers){var j=k(e.baselayers[i]);null!==j&&(g.baselayers[i]=j,e.baselayers[i].top===!0&&(c.addLayer(g.baselayers[i]),h=!0),g.controls.layers.addBaseLayer(g.baselayers[i],e.baselayers[i].name))}!h&&Object.keys(g.baselayers).length>0&&c.addLayer(g.baselayers[Object.keys(e.baselayers)[0]]),g.overlays={};for(i in e.overlays){var l=k(e.overlays[i]);null!==l&&(g.overlays[i]=l,e.overlays[i].visible===!0&&c.addLayer(g.overlays[i]),g.controls.layers.addOverlay(g.overlays[i],e.overlays[i].name))}d.$watch("layers.baselayers",function(a){for(var d in g.baselayers)void 0===a[d]&&(g.controls.layers.removeLayer(g.baselayers[d]),c.hasLayer(g.baselayers[d])&&c.removeLayer(g.baselayers[d]),delete g.baselayers[d]);for(var f in a)if(void 0===g.baselayers[f]){var h=k(a[f]);null!==h&&(g.baselayers[f]=h,a[f].top===!0&&c.addLayer(g.baselayers[f]),g.controls.layers.addBaseLayer(g.baselayers[f],a[f].name))}if(Object.keys(g.baselayers).length<=0)b.error("[AngularJS - Leaflet] At least one baselayer has to be defined");else{var i=!1;for(var j in g.baselayers)if(c.hasLayer(g.baselayers[j])){i=!0;break}i||c.addLayer(g.baselayers[Object.keys(e.baselayers)[0]])}},!0),d.$watch("layers.overlays",function(a){for(var b in g.overlays)void 0===a[b]&&(g.controls.layers.removeLayer(g.overlays[b]),c.hasLayer(g.overlays[b])&&c.removeLayer(g.overlays[b]),delete g.overlays[b]);for(var d in a)if(void 0===g.overlays[d]){var e=k(a[d]);null!==e&&(g.overlays[d]=e,g.controls.layers.addOverlay(g.overlays[d],a[d].name),a[d].visible===!0&&c.addLayer(g.overlays[d]))}},!0)}}function k(a){if(!c(a.type))return b.error("[AngularJS - Leaflet] A base layer must have a type"),null;if("xyz"!==a.type&&"wms"!==a.type&&"group"!==a.type&&"markercluster"!==a.type&&"google"!==a.type&&"bing"!==a.type)return b.error('[AngularJS - Leaflet] A layer must have a valid type: "xyz, wms, group, google"'),null;if(("xyz"===a.type||"wms"===a.type)&&!c(a.url))return b.error("[AngularJS - Leaflet] A base layer must have an url"),null;if(!c(a.name))return b.error("[AngularJS - Leaflet] A base layer must have a name"),null;(void 0===a.layerParams||null===a.layerParams||"object"!=typeof a.layerParams)&&(a.layerParams={}),(void 0===a.layerOptions||null===a.layerOptions||"object"!=typeof a.layerOptions)&&(a.layerOptions={});var d=null;for(var e in a.layerParams)a.layerOptions[e]=a.layerParams[e];switch(a.type){case"xyz":d=l(a.url,a.layerOptions);break;case"wms":d=m(a.url,a.layerOptions);break;case"group":d=n();break;case"markercluster":d=o(a.layerOptions);break;case"google":d=p(a.layerType,a.layerOptions);break;case"bing":d=q(a.bingKey,a.layerOptions);break;default:d=null}return d}function l(a,b){var c=L.tileLayer(a,b);return c}function m(a,b){var c=L.tileLayer.wms(a,b);return c}function n(){var a=L.layerGroup();return a}function o(a){if(i.MarkerClusterPlugin.isLoaded()){var b=new L.MarkerClusterGroup(a);return b}return null}function p(a,b){if(a=a||"SATELLITE",i.GoogleLayerPlugin.isLoaded()){var c=new L.Google(a,b);return c}return null}function q(a,b){if(i.BingLayerPlugin.isLoaded()){var c=new L.BingLayer(a,b);return c}return null}var r=g(d.defaults),s=h.getMap(),t=d.layers;j(s,t,r)}}}]),angular.module("leaflet-directive").directive("bounds",["$log",function(c){return{restrict:"A",scope:!1,replace:!1,transclude:!1,require:"leaflet",link:function(d,e,f,g){function h(c){return a(c)&&a(c.southWest)&&a(c.northEast)&&b(c.southWest.lat)&&b(c.southWest.lng)&&b(c.northEast.lat)&&b(c.northEast.lng)}function i(b){d.$watch("bounds",function(d){if(!a(d)||!h(d))return c.error("[AngularJS - Leaflet] Invalid bounds"),void 0;var e=d.southWest,f=d.northEast,g=new L.LatLngBounds(new L.LatLng(e.lat,e.lng),new L.LatLng(f.lat,f.lng));b.getBounds().equals(g)||b.fitBounds(g)},!0)}var j=g.getMap();i(j)}}}]),angular.module("leaflet-directive").directive("marker",["$log","$rootScope","leafletData",function(b,d,e){return{restrict:"A",scope:!1,replace:!1,transclude:!1,require:"leaflet",link:function(h,j,k,l){function m(b,c,g){if(a(c)){var i=n("marker",c,g,b);e.setMarker(i),i.on("click",function(){f(h,function(){d.$broadcast("leafletDirectiveMainMarkerClick")})})}}function n(a,e,g,j){function k(b,c){return function(g){var i="leafletDirectiveMarker."+b,j=a.replace("markers.","");"click"===b?f(h,function(){d.$broadcast("leafletDirectiveMarkersClick",j)}):"dragend"===b&&(f(h,function(){e.lat=l.getLatLng().lat,e.lng=l.getLatLng().lng}),e.message&&e.focus===!0&&l.openPopup()),f(h,function(a){"emit"===c?a.$emit(i,{markerName:j,leafletEvent:g}):d.$broadcast(i,{markerName:j,leafletEvent:g})})}}var l=o(e);if(void 0===e.layer)j.addLayer(l),e.focus===!0&&l.openPopup();else{if(!c(e.layer))return b.error("[AngularJS - Leaflet] A layername must be a string"),null;if(null===g)return b.error("[AngularJS - Leaflet] You must add layers to the directive if used in a marker"),null;if(null===g.overlays||void 0===g.overlays)return b.error("[AngularJS - Leaflet] You must add layers overlays to the directive if used in a marker"),null;if(void 0===g.overlays[e.layer]&&null===g.overlays[e.layer])return b.error("[AngularJS - Leaflet] You must use a name of an existing layer"),null;var m=g.overlays[e.layer];if(!(m instanceof L.LayerGroup))return b.error('[AngularJS - Leaflet] A marker can only be added to a layer of type "group"'),null;m.addLayer(l),j.hasLayer(l)&&e.focus===!0&&l.openPopup()}var n,p,q=["click","dblclick","mousedown","mouseover","mouseout","contextmenu","dragstart","drag","dragend","move","remove","popupopen","popupclose"],r=[],s="broadcast";if(void 0===h.eventBroadcast||null===h.eventBroadcast)r=q;else if("object"!=typeof h.eventBroadcast)b.warn("[AngularJS - Leaflet] event-broadcast must be an object check your model.");else if(void 0===h.eventBroadcast.marker||null===h.eventBroadcast.marker)r=q;else if("object"!=typeof h.eventBroadcast.marker)b.warn("[AngularJS - Leaflet] event-broadcast.marker must be an object check your model.");else{void 0!==h.eventBroadcast.marker.logic&&null!==h.eventBroadcast.marker.logic&&("emit"!==h.eventBroadcast.marker.logic&&"broadcast"!==h.eventBroadcast.marker.logic?b.warn("[AngularJS - Leaflet] Available event propagation logic are: 'emit' or 'broadcast'."):"emit"===h.eventBroadcast.marker.logic&&(s="emit"));var u=!1,v=!1;if(void 0!==h.eventBroadcast.marker.enable&&null!==h.eventBroadcast.marker.enable&&"object"==typeof h.eventBroadcast.marker.enable&&(u=!0),void 0!==h.eventBroadcast.marker.disable&&null!==h.eventBroadcast.marker.disable&&"object"==typeof h.eventBroadcast.marker.disable&&(v=!0),u&&v)b.warn("[AngularJS - Leaflet] can not enable and disable events at the same time");else if(u||v)if(u)for(n=0;n<h.eventBroadcast.marker.enable.length;n++)p=h.eventBroadcast.marker.enable[n],-1!==r.indexOf(p)?b.warn("[AngularJS - Leaflet] This event "+p+" is already enabled"):-1===q.indexOf(p)?b.warn("[AngularJS - Leaflet] This event "+p+" does not exist"):r.push(p);else for(r=q,n=0;n<h.eventBroadcast.marker.disable.length;n++){p=h.eventBroadcast.marker.disable[n];var w=r.indexOf(p);-1===w?b.warn("[AngularJS - Leaflet] This event "+p+" does not exist or has been already disabled"):r.splice(w,1)}else b.warn("[AngularJS - Leaflet] must enable or disable events")}for(n=0;n<r.length;n++)p=r[n],l.on(p,k(p,s),{eventName:p,scope_watch_name:a});var x=h.$watch(a,function(a,c){if(!a){if(l.closePopup(),void 0!==g&&null!==g&&void 0!==g.overlays)for(var d in g.overlays)g.overlays[d]instanceof L.LayerGroup&&g.overlays[d].hasLayer(l)&&g.overlays[d].removeLayer(l);return j.removeLayer(l),x(),void 0}if(c){if(void 0===a.layer||null===a.layer||"string"!=typeof a.layer)void 0!==c.layer&&null!==c.layer&&"string"==typeof c.layer&&(void 0!==g.overlays[c.layer]&&g.overlays[c.layer].hasLayer(l)&&(g.overlays[c.layer].removeLayer(l),l.closePopup()),j.hasLayer(l)||j.addLayer(l));else if(void 0===c.layer||null===c.layer||c.layer!==a.layer)if("string"==typeof c.layer&&void 0!==g.overlays[c.layer]&&g.overlays[c.layer].hasLayer(l)&&g.overlays[c.layer].removeLayer(l),l.closePopup(),j.hasLayer(l)&&j.removeLayer(l),void 0!==g.overlays[a.layer]){var e=g.overlays[a.layer];e instanceof L.LayerGroup?(e.addLayer(l),j.hasLayer(l)&&a.focus===!0&&l.openPopup()):b.error('[AngularJS - Leaflet] A marker can only be added to a layer of type "group"')}else b.error("[AngularJS - Leaflet] You must use a name of an existing layer");if(void 0===a.draggable||null===a.draggable||a.draggable!==!0?void 0!==c.draggable&&null!==c.draggable&&c.draggable===!0&&l.dragging&&l.dragging.disable():(void 0===c.draggable||null===c.draggable||c.draggable!==!0)&&(l.dragging?l.dragging.enable():L.Handler.MarkerDrag&&(l.dragging=new L.Handler.MarkerDrag(l),l.options.draggable=!0,l.dragging.enable())),void 0===a.icon||null===a.icon||"object"!=typeof a.icon)void 0!==c.icon&&null!==c.icon&&"object"==typeof c.icon&&(l.setIcon(new t),l.closePopup(),l.unbindPopup(),void 0!==a.message&&null!==a.message&&"string"==typeof a.message&&""!==a.message&&l.bindPopup(a.message));else if(void 0===c.icon||null===c.icon||"object"!=typeof c.icon){var f=!1;l.dragging&&(f=l.dragging.enabled()),i.AwesomeMarkersPlugin.is(a.icon)?l.setIcon(a.icon):i.Leaflet.DivIcon.is(a.icon)||i.Leaflet.Icon.is(a.icon)?l.setIcon(a.icon):l.setIcon(new t(a.icon)),f&&l.dragging.enable(),l.closePopup(),l.unbindPopup(),void 0!==a.message&&null!==a.message&&"string"==typeof a.message&&""!==a.message&&l.bindPopup(a.message)}else if(i.AwesomeMarkersPlugin.is(a.icon)){if(!i.AwesomeMarkersPlugin.equal(a.icon,c.icon)){var h=!1;l.dragging&&(h=l.dragging.enabled()),l.setIcon(a.icon),h&&l.dragging.enable(),l.closePopup(),l.unbindPopup(),void 0!==a.message&&null!==a.message&&"string"==typeof a.message&&""!==a.message&&l.bindPopup(a.message)}}else if(i.Leaflet.DivIcon.is(a.icon)){if(!i.Leaflet.DivIcon.equal(a.icon,c.icon)){var k=!1;l.dragging&&(k=l.dragging.enabled()),l.setIcon(a.icon),k&&l.dragging.enable(),l.closePopup(),l.unbindPopup(),void 0!==a.message&&null!==a.message&&"string"==typeof a.message&&""!==a.message&&l.bindPopup(a.message)}}else if(i.Leaflet.Icon.is(a.icon)){if(!i.Leaflet.Icon.equal(a.icon,c.icon)){var m=!1;l.dragging&&(m=l.dragging.enabled()),l.setIcon(a.icon),m&&l.dragging.enable(),l.closePopup(),l.unbindPopup(),void 0!==a.message&&null!==a.message&&"string"==typeof a.message&&""!==a.message&&l.bindPopup(a.message)}}else if(JSON.stringify(a.icon)!==JSON.stringify(c.icon)){var n=!1;l.dragging&&(n=l.dragging.enabled()),l.setIcon(new t(a.icon)),n&&l.dragging.enable(),l.closePopup(),l.unbindPopup(),void 0!==a.message&&null!==a.message&&"string"==typeof a.message&&""!==a.message&&l.bindPopup(a.message)}if(void 0===a.message||null===a.message||"string"!=typeof a.message||""===a.message?void 0!==c.message&&null!==c.message&&"string"==typeof c.message&&""!==c.message&&(l.closePopup(),l.unbindPopup()):void 0===c.message||null===c.message||"string"!=typeof c.message||""===c.message?(l.bindPopup(a.message),a.focus===!0&&l.openPopup()):a.message!==c.message&&l.setPopupContent(a.message),void 0===a.focus||null===a.focus||a.focus!==!0?void 0!==c.focus&&null!==c.focus&&c.focus===!0&&l.closePopup():(void 0===c.focus||null===c.focus||c.focus!==!0)&&l.openPopup(),void 0===a.lat||null===a.lat||isNaN(a.lat)||"number"!=typeof a.lat||void 0===a.lng||null===a.lng||isNaN(a.lng)||"number"!=typeof a.lng){if(b.warn("There are problems with lat-lng data, please verify your marker model"),null!==g&&void 0!==g.overlays&&null!==g.overlays)for(var o in g.overlays)(g.overlays[o]instanceof L.LayerGroup||i.MarkerClusterPlugin.is(g.overlays[o]))&&g.overlays[o].hasLayer(l)&&g.overlays[o].removeLayer(l);j.removeLayer(l)}else{var p=l.getLatLng();if(p.lat!==a.lat||p.lng!==a.lng){var q=!1;void 0!==a.layer&&null!==a.layer&&"string"==typeof a.layer&&i.MarkerClusterPlugin.is(g.overlays[a.layer])&&(g.overlays[a.layer].removeLayer(l),q=!0),l.setLatLng([a.lat,a.lng]),q&&g.overlays[a.layer].addLayer(l)}}}},!0);return l}function o(a){var b=null;b=a.icon?a.icon:new t;var c={icon:b,draggable:a.draggable?!0:!1};a.title&&(c.title=a.title);var d=new L.marker(a,c);return a.message&&d.bindPopup(a.message),d}var p=g(h.defaults),q=l.getMap(),r=h.marker,s=h.layers,t=L.Icon.extend({options:{iconUrl:p.icon.url,iconRetinaUrl:p.icon.retinaUrl,iconSize:p.icon.size,iconAnchor:p.icon.anchor,popupAnchor:p.icon.popup,shadowUrl:p.icon.shadow.url,shadowRetinaUrl:p.icon.shadow.retinaUrl,shadowSize:p.icon.shadow.size,shadowAnchor:p.icon.shadow.anchor}});m(q,r,s)}}}]),angular.module("leaflet-directive").directive("markers",["$log","$rootScope",function(b,c){return{restrict:"A",scope:!1,replace:!1,transclude:!1,require:"leaflet",link:function(d,e,h,j){function k(b,c,e){var f={};if(a(b)){for(var g in b){var h=l("markers."+g,b[g],e);null!==h&&(f[g]=h)}d.$watch("markers",function(a){for(var d in f)if(void 0===a[d]){if(f[d].closePopup(),void 0!==c&&null!==c&&void 0!==c.overlays)for(var g in c.overlays)c.overlays[g]instanceof L.LayerGroup&&c.overlays[g].hasLayer(f[d])&&c.overlays[g].removeLayer(f[d]);e.removeLayer(f[d]),delete f[d]}for(var h in a)if(void 0===f[h]){var i=l("markers."+h,b[h],e);null!==i&&(f[h]=i)}},!0)}}function l(e,g,h){function j(a,b){return function(h){var i="leafletDirectiveMarker."+a,j=e.replace("markers.","");"click"===a?f(d,function(){c.$broadcast("leafletDirectiveMarkersClick",j)}):"dragend"===a&&(f(d,function(){g.lat=k.getLatLng().lat,g.lng=k.getLatLng().lng}),g.message&&g.focus===!0&&k.openPopup()),f(d,function(a){"emit"===b?a.$emit(i,{markerName:j,leafletEvent:h}):c.$broadcast(i,{markerName:j,leafletEvent:h})})}}var k=m(g);if(void 0===g.layer)h.addLayer(k),g.focus===!0&&k.openPopup();else{if("string"!=typeof g.layer)return b.error("[AngularJS - Leaflet] A layername must be a string"),null;if(null===q)return b.error("[AngularJS - Leaflet] You must add layers to the directive if used in a marker"),null;if(null===q.overlays||void 0===q.overlays)return b.error("[AngularJS - Leaflet] You must add layers overlays to the directive if used in a marker"),null;if(void 0===q.overlays[g.layer]&&null===q.overlays[g.layer])return b.error("[AngularJS - Leaflet] You must use a name of an existing layer"),null;var l=q.overlays[g.layer];if(!(l instanceof L.LayerGroup))return b.error('[AngularJS - Leaflet] A marker can only be added to a layer of type "group"'),null;l.addLayer(k),h.hasLayer(k)&&g.focus===!0&&k.openPopup()}var n,o,p=["click","dblclick","mousedown","mouseover","mouseout","contextmenu","dragstart","drag","dragend","move","remove","popupopen","popupclose"],s=[],t="broadcast";if(void 0===d.eventBroadcast||null===d.eventBroadcast)s=p;else if("object"!=typeof d.eventBroadcast)b.warn("[AngularJS - Leaflet] event-broadcast must be an object check your model.");else if(void 0===d.eventBroadcast.marker||null===d.eventBroadcast.marker)s=p;else if("object"!=typeof d.eventBroadcast.marker)b.warn("[AngularJS - Leaflet] event-broadcast.marker must be an object check your model.");else{void 0!==d.eventBroadcast.marker.logic&&null!==d.eventBroadcast.marker.logic&&("emit"!==d.eventBroadcast.marker.logic&&"broadcast"!==d.eventBroadcast.marker.logic?b.warn("[AngularJS - Leaflet] Available event propagation logic are: 'emit' or 'broadcast'."):"emit"===d.eventBroadcast.marker.logic&&(t="emit"));var u=!1,v=!1;if(void 0!==d.eventBroadcast.marker.enable&&null!==d.eventBroadcast.marker.enable&&"object"==typeof d.eventBroadcast.marker.enable&&(u=!0),void 0!==d.eventBroadcast.marker.disable&&null!==d.eventBroadcast.marker.disable&&"object"==typeof d.eventBroadcast.marker.disable&&(v=!0),u&&v)b.warn("[AngularJS - Leaflet] can not enable and disable events at the same time");else if(u||v)if(u)for(n=0;n<d.eventBroadcast.marker.enable.length;n++)o=d.eventBroadcast.marker.enable[n],-1!==s.indexOf(o)?b.warn("[AngularJS - Leaflet] This event "+o+" is already enabled"):-1===p.indexOf(o)?b.warn("[AngularJS - Leaflet] This event "+o+" does not exist"):s.push(o);else for(s=p,n=0;n<d.eventBroadcast.marker.disable.length;n++){o=d.eventBroadcast.marker.disable[n];var w=s.indexOf(o);-1===w?b.warn("[AngularJS - Leaflet] This event "+o+" does not exist or has been already disabled"):s.splice(w,1)}else b.warn("[AngularJS - Leaflet] must enable or disable events")}for(n=0;n<s.length;n++)o=s[n],k.on(o,j(o,t),{eventName:o,scope_watch_name:e});var x=d.$watch(e,function(c,d){if(!a(c)){if(k.closePopup(),void 0!==q&&null!==q&&void 0!==q.overlays)for(var e in q.overlays)q.overlays[e]instanceof L.LayerGroup&&q.overlays[e].hasLayer(k)&&q.overlays[e].removeLayer(k);return h.removeLayer(k),x(),void 0}if(d){if(void 0===c.layer||null===c.layer||"string"!=typeof c.layer)void 0!==d.layer&&null!==d.layer&&"string"==typeof d.layer&&(void 0!==q.overlays[d.layer]&&q.overlays[d.layer].hasLayer(k)&&(q.overlays[d.layer].removeLayer(k),k.closePopup()),h.hasLayer(k)||h.addLayer(k));else if(void 0===d.layer||null===d.layer||d.layer!==c.layer)if("string"==typeof d.layer&&void 0!==q.overlays[d.layer]&&q.overlays[d.layer].hasLayer(k)&&q.overlays[d.layer].removeLayer(k),k.closePopup(),h.hasLayer(k)&&h.removeLayer(k),void 0!==q.overlays[c.layer]){var f=q.overlays[c.layer];f instanceof L.LayerGroup?(f.addLayer(k),h.hasLayer(k)&&c.focus===!0&&k.openPopup()):b.error('[AngularJS - Leaflet] A marker can only be added to a layer of type "group"')}else b.error("[AngularJS - Leaflet] You must use a name of an existing layer");if(void 0===c.draggable||null===c.draggable||c.draggable!==!0?void 0!==d.draggable&&null!==d.draggable&&d.draggable===!0&&k.dragging&&k.dragging.disable():(void 0===d.draggable||null===d.draggable||d.draggable!==!0)&&(k.dragging?k.dragging.enable():L.Handler.MarkerDrag&&(k.dragging=new L.Handler.MarkerDrag(k),k.options.draggable=!0,k.dragging.enable())),void 0===c.icon||null===c.icon||"object"!=typeof c.icon)void 0!==d.icon&&null!==d.icon&&"object"==typeof d.icon&&(k.setIcon(new r),k.closePopup(),k.unbindPopup(),void 0!==c.message&&null!==c.message&&"string"==typeof c.message&&""!==c.message&&k.bindPopup(c.message));else if(void 0===d.icon||null===d.icon||"object"!=typeof d.icon){var g=!1;k.dragging&&(g=k.dragging.enabled()),i.AwesomeMarkersPlugin.is(c.icon)?k.setIcon(c.icon):i.Leaflet.DivIcon.is(c.icon)||i.Leaflet.Icon.is(c.icon)?k.setIcon(c.icon):k.setIcon(new r(c.icon)),g&&k.dragging.enable(),k.closePopup(),k.unbindPopup(),void 0!==c.message&&null!==c.message&&"string"==typeof c.message&&""!==c.message&&k.bindPopup(c.message)}else if(i.AwesomeMarkersPlugin.is(c.icon)){if(!i.AwesomeMarkersPlugin.equal(c.icon,d.icon)){var j=!1;k.dragging&&(j=k.dragging.enabled()),k.setIcon(c.icon),j&&k.dragging.enable(),k.closePopup(),k.unbindPopup(),void 0!==c.message&&null!==c.message&&"string"==typeof c.message&&""!==c.message&&k.bindPopup(c.message)}}else if(i.Leaflet.DivIcon.is(c.icon)){if(!i.Leaflet.DivIcon.equal(c.icon,d.icon)){var l=!1;k.dragging&&(l=k.dragging.enabled()),k.setIcon(c.icon),l&&k.dragging.enable(),k.closePopup(),k.unbindPopup(),void 0!==c.message&&null!==c.message&&"string"==typeof c.message&&""!==c.message&&k.bindPopup(c.message)}}else if(i.Leaflet.Icon.is(c.icon)){if(!i.Leaflet.Icon.equal(c.icon,d.icon)){var m=!1;k.dragging&&(m=k.dragging.enabled()),k.setIcon(c.icon),m&&k.dragging.enable(),k.closePopup(),k.unbindPopup(),void 0!==c.message&&null!==c.message&&"string"==typeof c.message&&""!==c.message&&k.bindPopup(c.message)}}else if(JSON.stringify(c.icon)!==JSON.stringify(d.icon)){var n=!1;k.dragging&&(n=k.dragging.enabled()),k.setIcon(new r(c.icon)),n&&k.dragging.enable(),k.closePopup(),k.unbindPopup(),void 0!==c.message&&null!==c.message&&"string"==typeof c.message&&""!==c.message&&k.bindPopup(c.message)}if(void 0===c.message||null===c.message||"string"!=typeof c.message||""===c.message?void 0!==d.message&&null!==d.message&&"string"==typeof d.message&&""!==d.message&&(k.closePopup(),k.unbindPopup()):void 0===d.message||null===d.message||"string"!=typeof d.message||""===d.message?(k.bindPopup(c.message),c.focus===!0&&k.openPopup()):c.message!==d.message&&k.setPopupContent(c.message),void 0===c.focus||null===c.focus||c.focus!==!0?void 0!==d.focus&&null!==d.focus&&d.focus===!0&&k.closePopup():(void 0===d.focus||null===d.focus||d.focus!==!0)&&k.openPopup(),void 0===c.lat||null===c.lat||isNaN(c.lat)||"number"!=typeof c.lat||void 0===c.lng||null===c.lng||isNaN(c.lng)||"number"!=typeof c.lng){if(b.warn("There are problems with lat-lng data, please verify your marker model"),null!==q&&void 0!==q.overlays&&null!==q.overlays)for(var o in q.overlays)(q.overlays[o]instanceof L.LayerGroup||i.MarkerClusterPlugin.is(q.overlays[o]))&&q.overlays[o].hasLayer(k)&&q.overlays[o].removeLayer(k);h.removeLayer(k)}else{var p=k.getLatLng();if(p.lat!==c.lat||p.lng!==c.lng){var s=!1;void 0!==c.layer&&null!==c.layer&&"string"==typeof c.layer&&i.MarkerClusterPlugin.is(q.overlays[c.layer])&&(q.overlays[c.layer].removeLayer(k),s=!0),k.setLatLng([c.lat,c.lng]),s&&q.overlays[c.layer].addLayer(k)}}}},!0);return k}function m(a){var b=null;b=a.icon?a.icon:new r;var c={icon:b,draggable:a.draggable?!0:!1};a.title&&(c.title=a.title);var d=new L.marker(a,c);return a.message&&d.bindPopup(a.message),d}var n=g(d.defaults),o=j.getMap(),p=d.markers,q=d.layers,r=L.Icon.extend({options:{iconUrl:n.icon.url,iconRetinaUrl:n.icon.retinaUrl,iconSize:n.icon.size,iconAnchor:n.icon.anchor,popupAnchor:n.icon.popup,shadowUrl:n.icon.shadow.url,shadowRetinaUrl:n.icon.shadow.retinaUrl,shadowSize:n.icon.shadow.size,shadowAnchor:n.icon.shadow.anchor}});k(p,q,o)}}}]),angular.module("leaflet-directive").directive("paths",["$log",function(b){return{restrict:"A",scope:!1,replace:!1,transclude:!1,require:"leaflet",link:function(c,d,e,f){function h(d,e,f){var g={};if(a(d)){b.warn("[AngularJS - Leaflet] Creating polylines and adding them to the map will break the directive's scope's inspection in AngularJS Batarang");for(var h in d)g[h]=i(h,d[h],e,f);c.$watch("paths",function(b){for(var c in b)a(g[c])||(g[c]=i(c,b[c],e,f));for(var d in g)a(b[d])||delete g[d]},!0)}}function i(b,d,e,f){function g(a,b){if(void 0!==a.latlngs&&(void 0===b||a.latlngs!==b.latlngs))switch(a.type){default:case"polyline":case"polygon":h.setLatLngs(k(a.latlngs));break;case"multiPolyline":case"multiPolygon":h.setLatLngs(l(a.latlngs));break;case"rectangle":h.setBounds(new L.LatLngBounds(k(a.latlngs)));break;case"circle":case"circleMarker":h.setLatLng(j(a.latlngs)),void 0===a.radius||void 0!==b&&a.radius===b.radius||h.setRadius(a.radius)}void 0===a.weight||void 0!==b&&a.weight===b.weight||h.setStyle({weight:a.weight}),void 0===a.color||void 0!==b&&a.color===b.color||h.setStyle({color:a.color}),void 0===a.opacity||void 0!==b&&a.opacity===b.opacity||h.setStyle({opacity:a.opacity})}var h,i={weight:f.path.weight,color:f.path.color,opacity:f.path.opacity};switch(a(d.stroke)&&(i.stroke=d.stroke),a(d.fill)&&(i.fill=d.fill),a(d.fillColor)&&(i.fillColor=d.fillColor),a(d.fillOpacity)&&(i.fillOpacity=d.fillOpacity),a(d.smoothFactor)&&(i.smoothFactor=d.smoothFactor),a(d.noClip)&&(i.noClip=d.noClip),a(d.type)&&(d.type="polyline"),d.type){default:case"polyline":h=new L.Polyline([],i);
break;case"multiPolyline":h=new L.multiPolyline([[[0,0],[1,1]]],i);break;case"polygon":h=new L.Polygon([],i);break;case"multiPolygon":h=new L.MultiPolygon([[[0,0],[1,1],[0,1]]],i);break;case"rectangle":h=new L.Rectangle([[0,0],[1,1]],i);break;case"circle":h=new L.Circle([0,0],1,i);break;case"circleMarker":h=new L.CircleMarker([0,0],i)}g(d),e.addLayer(h);var m=c.$watch("paths."+b,function(a,b){return a?(g(a,b),void 0):(e.removeLayer(h),m(),void 0)},!0);return h}function j(a){return new L.LatLng(a.lat,a.lng)}function k(a){return a.filter(function(a){return!!a.lat&&!!a.lng}).map(function(a){return new L.LatLng(a.lat,a.lng)})}function l(a){return a.map(function(a){return k(a)})}var m=g(c.defaults),n=f.getMap(),o=c.paths;h(o,n,m)}}}]),angular.module("leaflet-directive").directive("eventBroadcast",["$log","$rootScope",function(a,b){return{restrict:"A",scope:!1,replace:!1,transclude:!1,require:"leaflet",link:function(c,d,e,g){function h(){function d(a,d){return function(e){var g="leafletDirectiveMap."+a;f(c,function(a){"emit"===d?a.$emit(g,{leafletEvent:e}):"broadcast"===d&&b.$broadcast(g,{leafletEvent:e})})}}var e,g,h=["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","contextmenu","focus","blur","preclick","load","unload","viewreset","movestart","move","moveend","dragstart","drag","dragend","zoomstart","zoomend","zoomlevelschange","resize","autopanstart","layeradd","layerremove","baselayerchange","overlayadd","overlayremove","locationfound","locationerror","popupopen","popupclose"],i=[],k="broadcast";if(void 0===c.eventBroadcast||null===c.eventBroadcast)i=h;else if("object"!=typeof c.eventBroadcast)a.warn("[AngularJS - Leaflet] event-broadcast must be an object check your model.");else if(void 0===c.eventBroadcast.map||null===c.eventBroadcast.map)i=h;else if("object"!=typeof c.eventBroadcast.map)a.warn("[AngularJS - Leaflet] event-broadcast.map must be an object check your model.");else{void 0!==c.eventBroadcast.map.logic&&null!==c.eventBroadcast.map.logic&&("emit"!==c.eventBroadcast.map.logic&&"broadcast"!==c.eventBroadcast.map.logic?a.warn("[AngularJS - Leaflet] Available event propagation logic are: 'emit' or 'broadcast'."):"emit"===c.eventBroadcast.map.logic&&(k="emit"));var l=!1,m=!1;if(void 0!==c.eventBroadcast.map.enable&&null!==c.eventBroadcast.map.enable&&"object"==typeof c.eventBroadcast.map.enable&&(l=!0),void 0!==c.eventBroadcast.map.disable&&null!==c.eventBroadcast.map.disable&&"object"==typeof c.eventBroadcast.map.disable&&(m=!0),l&&m)a.warn("[AngularJS - Leaflet] can not enable and disable events at the time");else if(l||m)if(l)for(e=0;e<c.eventBroadcast.map.enable.length;e++)g=c.eventBroadcast.map.enable[e],-1!==i.indexOf(g)?a.warn("[AngularJS - Leaflet] This event "+g+" is already enabled"):-1===h.indexOf(g)?a.warn("[AngularJS - Leaflet] This event "+g+" does not exist"):i.push(g);else for(i=h,e=0;e<c.eventBroadcast.map.disable.length;e++){g=c.eventBroadcast.map.disable[e];var n=i.indexOf(g);-1===n?a.warn("[AngularJS - Leaflet] This event "+g+" does not exist or has been already disabled"):i.splice(n,1)}else a.warn("[AngularJS - Leaflet] must enable or disable events")}for(e=0;e<i.length;e++)g=i[e],j.on(g,d(g,k),{eventName:g})}function i(){if("object"!=typeof c.events)return!1;for(var a in c.events)j.on(a,c.events[a])}var j=g.getMap();c.legend,i(),h()}}}]),angular.module("leaflet-directive").directive("maxbounds",["$log",function(){return{restrict:"A",scope:!1,replace:!1,transclude:!1,require:"leaflet",link:function(c,d,e,f){function h(d,e){a(e.southWest)&&a(e.northEast)&&c.$watch("maxBounds",function(c){a(c.southWest)&&a(c.northEast)&&b(c.southWest.lat)&&b(c.southWest.lng)&&b(c.northEast.lat)&&b(c.northEast.lng)&&d.setMaxBounds(new L.LatLngBounds(new L.LatLng(c.southWest.lat,c.southWest.lng),new L.LatLng(c.northEast.lat,c.northEast.lng)))})}g(c.defaults);var i=f.getMap(),j=c.maxBounds;h(i,j)}}}]),angular.module("leaflet-directive").service("leafletData",["$log",function(){var a,b,c;this.setMap=function(b){a=b},this.getMap=function(){return a},this.setTile=function(a){b=a},this.getTile=function(){return b},this.setMainMarker=function(a){c=a},this.getMainMarker=function(){return c}}])}();