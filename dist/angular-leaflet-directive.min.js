/**!
 * The MIT License
 *
 * Copyright (c) 2013 the angular-leaflet-directive team, http://tombatossals.github.io/angular-leaflet-directive
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 * angular-google-maps
 * https://github.com/tombatossals/angular-leaflet-directive
 *
 * @authors https://github.com/tombatossals/angular-leaflet-directive/graphs/contributors
 */

/*! angular-leaflet-directive 20-10-2013 */
!function(){"use strict";function a(a){return angular.isDefined(a)}function b(a){return angular.isNumber(a)}function c(a,b){return angular.equals(a,b)}function d(b){var c=e();return a(b)&&(c.maxZoom=a(b.maxZoom)?parseInt(b.maxZoom,10):c.maxZoom,c.minZoom=a(b.minZoom)?parseInt(b.minZoom,10):c.minZoom,c.doubleClickZoom=a(b.doubleClickZoom)&&b.doubleClickZoom?!0:!1,c.scrollWheelZoom=a(b.scrollWheelZoom)&&b.scrollWheelZoom?!0:!1,c.attributionControl=a(b.attributionControl)&&b.attributionControl?!0:!1,c.tileLayer=a(b.tileLayer)?b.tileLayer:c.tileLayer,b.tileLayerOptions&&angular.copy(b.tileLayerOptions,c.tileLayerOptions)),c}function e(){return{maxZoom:14,minZoom:1,doubleClickZoom:!0,scrollWheelZoom:!0,zoomControl:!0,attributionControl:!0,zoomsliderControl:!1,controlLayersPosition:"topright",tileLayer:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",tileLayerOptions:{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},icon:{url:"http://cdn.leafletjs.com/leaflet-0.6.4/images/marker-icon.png",retinaUrl:"http://cdn.leafletjs.com/leaflet-0.6.4/images/marker-icon-2x.png",size:[25,41],anchor:[12,40],popup:[0,-40],shadow:{url:"http://cdn.leafletjs.com/leaflet-0.6.4/images/marker-shadow.png",retinaUrl:"http://cdn.leafletjs.com/leaflet-0.6.4/images/marker-shadow.png",size:[41,41],anchor:[12,40]}},path:{weight:10,opacity:1,color:"#0000ff"},center:{lat:0,lng:0,zoom:1}}}angular.module("leaflet-directive",[]).directive("leaflet",["$http","$log","$parse","$rootScope",function(b,c){return{restrict:"E",replace:!0,transclude:!0,scope:{center:"=center",defaults:"=defaults",maxBounds:"=maxbounds",bounds:"=bounds",marker:"=marker",markers:"=markers",legend:"=legend",geojson:"=geojson",paths:"=paths",tiles:"=tiles",events:"=events",layers:"=layers",customControls:"=customControls",leafletMap:"=leafletmap",eventBroadcast:"=eventBroadcast"},template:'<div class="angular-leaflet-map"></div>',controller:["$scope",function(a){this.getMap=function(){return a.map}}],link:function(b,e,f){var g=d(b.defaults);b.maxBounds&&(g.minZoom=void 0),f.width&&(isNaN(f.width)?e.css("width",f.width):e.css("width",f.width+"px")),f.height&&(isNaN(f.height)?e.css("height",f.height):e.css("height",f.height+"px"));var h=new L.Map(e[0],{maxZoom:g.maxZoom,minZoom:g.minZoom,doubleClickZoom:g.doubleClickZoom,scrollWheelZoom:g.scrollWheelZoom,attributionControl:g.attributionControl});if(b.map=h,a(f.center)||(c.warn("[AngularJS - Leaflet] 'center' is undefined in the current scope, did you forget to initialize it?"),h.setView([g.center.lat,g.center.lng],g.center.zoom)),!a(f.tiles)){var i=g.tileLayer,j=g.tileLayerOptions,k=L.tileLayer(i,j);k.addTo(h)}}}}]),angular.module("leaflet-directive").directive("center",["$http","$log","$parse","$rootScope",function(e,f,g){return{restrict:"A",scope:!1,replace:!1,transclude:!1,require:"leaflet",link:function(e,h,i,j){function k(){}function l(a,b){a.setView([b.lat,b.lng],b.zoom),k()}function m(c){return a(c)&&b(c.lat)&&b(c.lng)&&b(c.zoom)}function n(){var a=e.$root.$$phase;return!("$apply"===a||"$digest"===a)}function o(a){n()?e.$apply(a):e.$eval(a)}function p(a,d,h){b(d.lat)&&b(d.lng)&&b(d.zoom)?l(a,d):d.autoDiscover===!0?a.locate({setView:!0,maxZoom:h.maxZoom}):(f.warn("[AngularJS - Leaflet] 'center' is incorrect"),l(a,h.center));var i={lat:g("center.lat"),lng:g("center.lng"),zoom:g("center.zoom")},j=!1;e.$watch("center",function(b,d){return m(b)?(j||c(b,d)||l(a,b),void 0):(f.warn("[AngularJS - Leaflet] invalid 'center'"),l(a,h.center),void 0)},!0),a.on("movestart",function(){j=!0}),a.on("moveend",function(){j=!1,o(function(b){i&&(i.lat.assign(b,a.getCenter().lat),i.lng.assign(b,a.getCenter().lng),i.zoom.assign(b,a.getZoom())),k()})})}var q=d(e.defaults),r=j.getMap(),s=e.center;p(r,s,q)}}}]),angular.module("leaflet-directive").directive("tiles",["$http","$log","$parse","$rootScope",function(){return{restrict:"A",scope:!1,replace:!1,transclude:!1,require:"leaflet",link:function(a,b,c,e){function f(b,c,d){var e,f=d.tileLayer,g=d.tileLayerOptions;angular.isDefined(c.url)&&(f=c.url),angular.isDefined(c.options)&&angular.copy(c.options,g),a.$watch("tiles.url",function(a){angular.isDefined(a)&&e.setUrl(a)}),e=L.tileLayer(f,g),e.addTo(b)}var g=d(a.defaults),h=e.getMap(),i=a.tiles;f(h,i,g)}}}]),angular.module("leaflet-directive").directive("maxbounds",["$http","$log","$parse","$rootScope",function(){return{restrict:"A",scope:!1,replace:!1,transclude:!1,require:"leaflet",link:function(c,e,f,g){function h(d,e){a(e.southWest)&&a(e.northEast)&&c.$watch("maxBounds",function(c){a(c.southWest)&&a(c.northEast)&&b(c.southWest.lat)&&b(c.southWest.lng)&&b(c.northEast.lat)&&b(c.northEast.lng)&&d.setMaxBounds(new L.LatLngBounds(new L.LatLng(c.southWest.lat,c.southWest.lng),new L.LatLng(c.northEast.lat,c.northEast.lng)))})}d(c.defaults);var i=g.getMap(),j=c.maxBounds;h(i,j)}}}])}();